<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{_common/layout::layout(~{::header/content()}, ~{::body/content()}, '従業員管理')}">
<header>
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">システム管理</li>
      <li class="breadcrumb-item active" aria-current="page">従業員管理</li>
    </ol>
  </nav>
</header>
<body>
<div>
  <div class="row g-4">
    <div class="col" th:each="employee : ${screen.employeeList}" th:object="${employee}" style="max-width: 14rem; min-width: 14rem">
      <div class="card h-100 shadow">
        <div class="card-body">
          <div th:text="*{number}"></div>
          <div th:text="*{fullName}"></div>
          <div th:text="*{loginId + '@example.com'}"></div>
        </div>
        <div class="card-footer text-end">
          <a class="btn btn-secondary" th:href="@{/admin/manage/employees/{id}(id=*{id})}">
            <i class="fa-solid fa-pen-to-square"></i>
          </a>
          <a class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteConfirmModal"
            th:data-delete-id="*{id}" th:data-delete-number="*{number}" th:data-delete-full-name="*{fullName}">
            <i class="fa-solid fa-trash"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
  <!-- 削除確認モーダル -->
  <div class="modal fade" id="deleteConfirmModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="deleteConfirmModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteConfirmModalLabel">削除確認</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          以下の従業員情報を削除します。
          <div class="row mt-3 mx-auto">
            <div class="col-5 fw-bold text-end">社員番号</div>
            <div class="col-7" id="deleteEmployeeNumber"></div>
          </div>
          <div class="row mt-2 mx-auto">
            <div class="col-5 fw-bold text-end">名前</div>
            <div class="col-7" id="deleteEmployeeFullName"></div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
          <form th:action="@{/admin/manage/employees}" th:object="${deleteForm}" th:method="delete">
            <input type="hidden" id="deleteEmployeeId" name="deleteEmployeeId">
            <button type="submit" class="btn btn-danger">
              <i class="fa-solid fa-trash"></i>削除
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  // 削除モーダル表示時の処理
  $('#deleteConfirmModal').on('show.bs.modal', function (event) {
    // 値を取得
    let button = $(event.relatedTarget);
    let id = button.data('delete-id');
    let number = button.data('delete-number');
    let fullName = button.data('delete-full-name');
    // モーダル側に値を設定
    $('#deleteEmployeeId').val(id)
    $('#deleteEmployeeNumber').text(number)
    $('#deleteEmployeeFullName').text(fullName)
  })
</script>
</body>
</html>